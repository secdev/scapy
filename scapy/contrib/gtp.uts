# GTP unit tests
#
# Type the following command to launch start the tests:
# $ test/run_tests -P "load_contrib('gtp')" -t scapy/contrib/gtp.uts

+ GTPv1

= GTPCreatePDPContextRequest(), basic instantiation
gtp = IP()/UDP(dport=2123)/gtp_v1.GTPHeader(teid=2807) / \
    gtp_v1.GTPCreatePDPContextRequest()
gtp.dport == 2123 and gtp.teid == 2807 and len(gtp.IE_list) == 5

= GTPV1UpdatePDPContextRequest(), dissect
h = "3333333333332222222222228100a38408004588006800000000fd1134820a2a00010a2a00024aa5084b005408bb32120044ed99aea9386f0000100000530514058500040a2a00018500040a2a000187000c0213921f739680fe74f2ffff94000130970001019800080112f41004d204d29900024000b6000101"
gtp = Ether(h.decode('hex'))
gtp.gtp_type == 18

= GTPV1UpdatePDPContextResponse(), dissect
h = "3333333333332222222222228100838408004588005400000000fd1182850a2a00010a2a0002084b084b00406b46321300305843da17f07300000180100000032c7f4a0f58108500040a2a00018500040a2a000187000f0213921f7396d1fe7482ffff004a00f7a71e0a"
gtp = Ether(h.decode('hex'))
gtp.gtp_type == 19

= IE_Cause(), dissect
h = "3333333333332222222222228100838408004588005400000000fd1182850a2a00010a2a0002084b084b00406b4632130030f15422be19ed0000018010000046a97f4a0f58108500040a2a00018500040a2a000187000f0213921f7396d1fe7482ffff004a00f7a71e0a"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[0]
ie.ietype == 1 and ie.CauseValue == 128

= IE_Cause(), basic instantiation
ie = gtp_v1.IE_Cause(CauseValue='IMSI not known')
ie.ietype == 1 and ie.CauseValue == 194

= IE_IMSI(), dissect
h = "333333333333222222222222810083840800458800ba00000000fc1185060a2a00010a2a00024ace084b00a68204321000960eeec43e99ae00000202081132547600000332f42004d27b0ffc102c0787b611b2f9023914051a0400800002f1218300070661616161616184001480802110010100108106000000008306000000008500040a2a00018500040a2a00018600079111111111111187000d0213621f7396737374f2ffff0094000120970001029800080032f42004d204d299000240009a00081111111111110000d111193b"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[0]
ie.ietype == 2 and ie.imsi == '2080112345670000'

= IE_IMSI(), basic instantiation
ie = gtp_v1.IE_IMSI(imsi='208103397660354')
ie.ietype == 2 and ie.imsi == '208103397660354'

= IE_Routing(), dissect
h = "33333333333322222222222281008384080045880072647100003e11dcf60a2a00010a2a0002084b084b005e78d93212004ef51a4ac3a291ff000332f42004d27b10eb3981b414058500040a2a00018500040a2a000187000f0213921f7396d1fe7482ffff004a0094000110970001019800080132f42004d204d299000240fcb60001015bf2090f"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[0]
ie.ietype == 3 and ie.MCC == '234' and ie.MNC == '02' and ie.LAC == 1234 and ie.RAC == 123

= IE_Routing(), basic instantiation
ie = gtp_v1.IE_Routing(MCC='234', MNC='02', LAC=1234, RAC=123)
ie.ietype == 3 and ie.MCC == '234' and ie.MNC == '02' and ie.LAC == 1234 and ie.RAC == 123

= IE_Recovery(), dissect
h = "3333333333332222222222228100038408004500002ac6e60000fd11ccbc0a2a00010a2a0002084b084b001659db32020006c192a26c8cb400000e0e00000000f4b40b31"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[0]
ie.ietype == 14 and ie.restart_counter == 14

= IE_Recovery(), basic instantiation
ie = gtp_v1.IE_Recovery(restart_counter=14)
ie.ietype == 14 and ie.restart_counter == 14

= IE_SelectionMode(), dissect
h = "333333333333222222222222810083840800458800c500000000fc1184df0a2a00010a2a00024a55084b00b1f62a321000a11c025b77dccc00000202081132547600000332f42004d27b0ffc1055080923117c347b6a14051a0a00800002f1218300070661616161616184001d8080211001000010810600000000830600000000000d00000a000005008500040a2a00018500040a2a00018600079111111111111187000f0213921f7396d3fe74f2ffff00640094000120970001019800080132f42004d204d299000240009a00081111111111110000eea69220"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[2]
ie.ietype == 15 and ie.SelectionMode == 252

= IE_SelectionMode(), basic instantiation
ie = gtp_v1.IE_SelectionMode(SelectionMode=252)
ie.ietype == 15 and ie.SelectionMode == 252

= IE_TEIDI(), dissect
h = "3333333333332222222222228100838408004588005400000000fd1182850a2a00010a2a0002084b084b00406b46321300303f0ff4fb966f00000180109a0f08ef7f3af826978500040a2a00018500040a2a000187000f0213921f7396d1fe7482ffff004a00f7a71e0a"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[1]
ie.ietype == 16 and ie.TEIDI == 0x9a0f08ef

= IE_TEIDI(), basic instantiation
ie = gtp_v1.IE_TEIDI(TEIDI=0x9a0f08ef)
ie.ietype == 16 and ie.TEIDI == 0x9a0f08ef

= IE_TEICP(), dissect
h = "333333333333222222222222810083840800458800c500000000fc1184df0a2a00010a2a00024a55084b00b1f62a321000a1b75eb617464800000202081132547600000332f42004d27b0ffc10db5c765711ba5d87ba14051a0a00800002f1218300070661616161616184001d8080211001000010810600000000830600000000000d00000a000005008500040a2a00018500040a2a00018600079111111111111187000f0213921f7396d3fe74f2ffff00640094000120970001019800080132f42004d204d299000240009a00081111111111110000eea69220"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[4]
ie.ietype == 17 and ie.TEICI == 0xba5d87ba

= IE_TEICP(), basic instantiation
ie = gtp_v1.IE_TEICP(TEICI=0xba5d87ba)
ie.ietype == 17 and ie.TEICI == 0xba5d87ba

= IE_Teardown(), dissect
h = "3333333333332222222222228100838408004588002c00000000fd1184640a2a00010a2a00023d66084b00184c2232140008ba66ce5b6efe000013ff14050000c309006c"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[0]
ie.ietype == 19 and ie.indicator == 255

= IE_Teardown(), basic instantiation
ie = gtp_v1.IE_Teardown(indicator='True')
ie.ietype == 19 and ie.indicator == 255

= IE_NSAPI(), dissect
h = "3333333333332222222222228100838408004588002c00000000fd1184640a2a00010a2a00023d66084b00184c2232140008dafc273ee7ab000013ff14050000c309006c"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[1]
ie.ietype == 20 and ie.NSAPI == 5

= IE_NSAPI(), basic instantiation
ie = gtp_v1.IE_NSAPI(NSAPI=5)
ie.ietype == 20 and ie.NSAPI == 5

= IE_ChargingCharacteristics(), dissect
h = "333333333333222222222222810083840800458800bc00000000fc1184c90a2a00010a2a00024acf084b00a87bbb32100098a3e2565004a400000202081132547600000332f42004d27b0ffc10b87f17ad11c53c5e1b14051a0400800002f1218300070661616161616184001480802110010000108106000000008306000000008500040a2a00018500040a2a00018600079111111111111187000f0213921f7396d3fe74f2ffff004a0094000120970001019800080132f42004d204d299000240009a00081111111111110000951c5bbe"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[6]
ie.ietype == 26 and ie.normal_charging == 0 and ie.prepaid_charging == 1 and ie.flat_rate_charging == 0

= IE_ChargingCharacteristics(), basic instantiation
ie = gtp_v1.IE_ChargingCharacteristics(
    normal_charging=0, prepaid_charging=1, flat_rate_charging=0)
ie.ietype == 26 and ie.normal_charging == 0 and ie.prepaid_charging == 1 and ie.flat_rate_charging == 0

= IE_TraceReference(), basic instantiation
ie = gtp_v1.IE_TraceReference(Trace_reference=0x1212)
ie.ietype == 27 and ie.Trace_reference == 0x1212

= IE_TraceType(), basic instantiation
ie = gtp_v1.IE_TraceType(Trace_type=0x1212)
ie.ietype == 28 and ie.Trace_type == 0x1212

= IE_ChargingId(), dissect
h = "3333333333332222222222228100838408004588005400000000fd1182850a2a00010a2a0002084b084b00406b4632130030e77ffb7e30410000018010ed654ff37fff1bc3f28500040a2a00018500040a2a000187000f0213921f7396d1fe7482ffff004a00f7a71e0a"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[2]
ie.ietype == 127 and ie.Charging_id == 0xff1bc3f2

= IE_ChargingId(), basic instantiation
ie = gtp_v1.IE_ChargingId(Charging_id=0xff1bc3f2)
ie.ietype == 127 and ie.Charging_id == 0xff1bc3f2

= IE_EndUserAddress(), dissect
h = "3333333333332222222222228100838408004588008500000000fd11840b0a2a00010a2a0002084b4a6c00717c8a32110061c1b9728f356a0000018008fe10af709e9011e3cb6a4b7fb60e1b28800006f1210a2a00038400218080210a0301000a03060ab0aa93802110030100108106ac14020a8306ac1402278500040a2a00018500040a2a000187000c0213621f7396486874f2ffff44ded108"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[5]
ie.ietype == 128 and ie.length == 6 and ie.PDPTypeOrganization == 1 and ie.PDPTypeNumber == 0x21 and ie.PDPAddress == '10.42.0.3'

= IE_EndUserAddress(), basic instantiation
ie = gtp_v1.IE_EndUserAddress(
    length=6, PDPTypeOrganization=1, PDPTypeNumber=0x21, PDPAddress='10.42.0.3')
ie.ietype == 128 and ie.length == 6 and ie.PDPTypeOrganization == 1 and ie.PDPTypeNumber == 0x21 and ie.PDPAddress == '10.42.0.3'

= IE_AccessPointName(), dissect
h = "333333333333222222222222810083840800458800bc00000000fc1184c90a2a00010a2a00024acf084b00a87bbb3210009867fe972185e800000202081132547600000332f42004d27b0ffc1093b20c3f11940eb2bf14051a0400800002f1218300070661616161616184001480802110010000108106000000008306000000008500040a2a00018500040a2a00018600079111111111111187000f0213921f7396d3fe74f2ffff004a0094000120970001019800080132f42004d204d299000240009a000811111111111100001b1212951c5bbe"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[8]
ie.ietype == 131 and ie.APN == 'aaaaaa'

= IE_AccessPointName(), basic instantiation
ie = gtp_v1.IE_AccessPointName(APN='aaaaaa')
ie.ietype == 131 and ie.APN == 'aaaaaa'

= IE_ProtocolConfigurationOptions(), dissect
h = "333333333333222222222222810083840800458800c300000000fc1184e50a2a00010a2a00024a4d084b00af41993210009fdef90e15440900000202081132547600000332f42004d27b0ffc10c29998b81145c6c9ee14051a0a00800002f1218300070661616161616184001d80c02306010100060000802110010100108106000000008306000000008500040a2a00018500040a2a00018600079111111111111187000d0213621f73967373741affff0094000120970001029800080032f42004d204d299000240009a0008111111111111000081182fb2"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[9]
ie.ietype == 132 and ie.Protocol_Configuration == '\x80\xc0#\x06\x01\x01\x00\x06\x00\x00\x80!\x10\x01\x01\x00\x10\x81\x06\x00\x00\x00\x00\x83\x06\x00\x00\x00\x00'

= IE_ProtocolConfigurationOptions(), basic instantiation
ie = gtp_v1.IE_ProtocolConfigurationOptions(
    length=29, Protocol_Configuration='\x80\xc0#\x06\x01\x01\x00\x06\x00\x00\x80!\x10\x01\x01\x00\x10\x81\x06\x00\x00\x00\x00\x83\x06\x00\x00\x00\x00')
ie.ietype == 132 and ie.Protocol_Configuration == '\x80\xc0#\x06\x01\x01\x00\x06\x00\x00\x80!\x10\x01\x01\x00\x10\x81\x06\x00\x00\x00\x00\x83\x06\x00\x00\x00\x00'

= IE_GSNAddress(), dissect
h = "3333333333332222222222228100838408004588005400000000fd1182850a2a00010a2a0002084b084b00406b463213003031146413c18000000180109181ba027fcf701a8c8500040a2a00018500040a2a000187000f0213921f7396d1fe7482ffff004a00f7a71e0a"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[3]
ie.ietype == 133 and ie.address == '10.42.0.1'

= IE_GSNAddress(), basic instantiation
ie = gtp_v1.IE_GSNAddress(address='10.42.0.1')
ie.ietype == 133 and ie.address == '10.42.0.1'

= IE_MSInternationalNumber(), dissect
h = "333333333333222222222222810083840800458800c300000000fc1184e50a2a00010a2a00024a4d084b00af41993210009f79504a3e048e00000202081132547600000332f42004d27b0ffc10a692773d1158da9e2214051a0a00800002f1218300070661616161616184001d80c02306010100060000802110010100108106000000008306000000008500040a2a00018500040a2a00018600079111111111111187000d0213621f73967373741affff0094000120970001029800080032f42004d204d299000240009a0008111111111111000081182fb2"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[12]
ie.ietype == 134 and ie.flags == 145 and ie.digits == '111111111111'

= IE_MSInternationalNumber(), basic instantiation
ie = gtp_v1.IE_MSInternationalNumber(flags=145, digits='111111111111')
ie.ietype == 134 and ie.flags == 145 and ie.digits == '111111111111'

= IE_QoS(), dissect
h = "3333333333332222222222228100838408004588005400000000fd1182850a2a00010a2a0002084b084b00406b4632130030afe9d3a3317e0000018010bd82f3997f9febcaf58500040a2a00018500040a2a000187000f0213921f7396d1fe7482ffff004a00f7a71e0a"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[5]
ie.ietype == 135 and ie.allocation_retention_prioiry == 2 and ie.delay_class == 2 and ie.traffic_class == 3

= IE_QoS(), basic instantiation
ie = gtp_v1.IE_QoS(
    allocation_retention_prioiry=2, delay_class=2, traffic_class=3)
ie.ietype == 135 and ie.allocation_retention_prioiry == 2 and ie.delay_class == 2 and ie.traffic_class == 3

= IE_CommonFlags(), dissect
h = "3333333333332222222222228100a38408004588006800000000fd1134820a2a00010a2a00024aa5084b005408bb32120044623f97e3ac610000104d82c69214058500040a2a00018500040a2a000187000c0213921f739680fe74f2ffff94000130970001019800080132f42004d204d29900024000b6000101"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[5]
ie.ietype == 148 and ie.nrsn == 1 and ie.no_qos_nego == 1 and ie.prohibit_payload_compression == 0

= IE_CommonFlags(), basic instantiation
ie = gtp_v1.IE_CommonFlags(nrsn=1, no_qos_nego=1)
ie.ietype == 148 and ie.nrsn == 1 and ie.no_qos_nego == 1 and ie.prohibit_payload_compression == 0

= IE_APNRestriction(), basic instantiation
ie = gtp_v1.IE_APNRestriction(restriction_type_value=12)
ie.ietype == 149 and ie.restriction_type_value == 12

= IE_RATType(), dissect
h = "3333333333332222222222228100a38408004588006800000000fd1134820a2a00010a2a00024aa5084b005408bb321200442f686a89d33c000010530ec20a14058500040a2a00018500040a2a000187000c0213921f739680fe74f2ffff94000130970001019800080132f42004d204d29900024000b6000101"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[6]
ie.ietype == 151 and ie.RAT_Type == 1

= IE_RATType(), basic instantiation
ie = gtp_v1.IE_RATType(RAT_Type=1)
ie.ietype == 151 and ie.RAT_Type == 1

= IE_UserLocationInformation(), dissect
h = "3333333333332222222222228100a38408004588006800000000fd1134820a2a00010a2a00024aa5084b005408bb32120044981eb5dcb29400001016e85d9f14058500040a2a00018500040a2a000187000c0213921f739680fe74f2ffff94000130970001019800080132f42004d204d29900024000b6000101"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[7]
ie.MCC == '234' and ie.MNC == '02' and ie.LAC == 1234 and ie.SAC == 1234

= IE_UserLocationInformation(), basic instantiation
ie = gtp_v1.IE_UserLocationInformation(MCC='234', MNC='02', LAC=1234, SAC=1234)
ie.ietype == 152 and ie.MCC == '234' and ie.MNC == '02' and ie.LAC == 1234 and ie.SAC == 1234

= IE_MSTimeZone(), dissect
h = "3333333333332222222222228100a38408004588006800000000fd1134820a2a00010a2a00024aa5084b005408bb32120044f24a4d5825290000102ca9c8c314058500040a2a00018500040a2a000187000c0213921f739680fe74f2ffff94000130970001019800080132f42004d204d29900024000b6000101"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[8]
ie.ietype == 153 and ie.timezone == 64 and ie.daylight_saving_time == 0

= IE_MSTimeZone(), basic instantiation
ie = gtp_v1.IE_MSTimeZone(timezone=64)
ie.ietype == 153 and ie.timezone == 64 and ie.daylight_saving_time == 0

= IE_IMEI(), dissect
h = "333333333333222222222222810083840800458800c300000000fc1184e50a2a00010a2a00024a4d084b00af41993210009f2f3ae0eb7b9c00000202081132547600000332f42004d27b0ffc10424a10c8117ca21aba14051a0a00800002f1218300070661616161616184001d80c02306010100060000802110010100108106000000008306000000008500040a2a00018500040a2a00018600079111111111111187000d0213621f73967373741affff0094000120970001029800080032f42004d204d299000240009a0008111111111111000081182fb2"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[18] and ie.ietype == 154 and ie.IMEI == '0132750094080322'

= IE_IMEI(), basic instantiation
ie = gtp_v1.IE_IMEI(IMEI='0132750094080322')
ie.ietype == 154 and ie.IMEI == '0132750094080322'

= IE_MSInfoChangeReportingAction(), basic instantiation
ie = gtp_v1.IE_MSInfoChangeReportingAction(Action=12)
ie.ietype == 181 and ie.Action == 12

= IE_DirectTunnelFlags(), dissect
h = "3333333333332222222222228100a38408004588006800000000fd1134820a2a00010a2a00024aa5084b005408bb32120044d2a7dffabfb70000108caa6b0b14058500040a2a00018500040a2a000187000c0213921f739680fe74f2ffff94000130970001019800080132f42004d204d29900024000b6000101"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[9]
ie.ietype == 182 and ie.EI == 0 and ie.GCSI == 0 and ie.DTI == 1

= IE_DirectTunnelFlags(), basic instantiation
ie = gtp_v1.IE_DirectTunnelFlags(DTI=1)
ie.ietype == 182 and ie.EI == 0 and ie.GCSI == 0 and ie.DTI == 1

= IE_BearerControlMode(), basic instantiation
ie = gtp_v1.IE_BearerControlMode(bearer_control_mode=1)
ie.ietype == 184 and ie.bearer_control_mode == 1

= IE_EvolvedAllocationRetentionPriority(), basic instantiation
ie = gtp_v1.IE_EvolvedAllocationRetentionPriority(PCI=1)
ie.ietype == 191 and ie.PCI == 1

= IE_CharginGatewayAddress(), basic instantiation
ie = gtp_v1.IE_CharginGatewayAddress()
ie.ietype == 251 and ie.ipv4_address == '127.0.0.1' and ie.ipv6_address == '::1'

= IE_PrivateExtension(), basic instantiation
ie = gtp_v1.IE_PrivateExtension(extention_value='hello')
ie.ietype == 255 and ie.extention_value == 'hello'

+ GTPv2

= GTPHeader v2, basic instanciation
gtp = IP()/UDP(dport=2123)/gtp_v2.GTPHeader(gtp_type=1)
gtp.dport == 2123 and gtp.gtp_type == 1

= GTPV2EchoRequest, basic instantiation
gtp = IP()/UDP(dport=2123)/gtp_v2.GTPHeader(gtp_type="create_session_req") / \
    gtp_v2.GTPV2CreateSessionRequest(teid=2807, seq=12345)
gtp.dport == 2123 and gtp.teid == 2807 and gtp.seq == 12345

= GTPV2CreateSessionRequest, basic instantiation
gtp = IP()/UDP(dport=2123)/gtp_v2.GTPHeader(gtp_type="create_session_req") / \
    gtp_v2.GTPV2CreateSessionRequest(teid=2807, seq=12345)
gtp.dport == 2123 and gtp.teid == 2807 and gtp.seq == 12345

= GTPV2EchoRequest, dissection
h = "333333333333222222222222810080c808004588002937dd0000fd1115490a2a00010a2a0002084b084b00152d0e4001000900000100030001000daa000000003f1f382f"
gtp = Ether(h.decode('hex'))
gtp.gtp_type == 1

= GTPV2EchoResponse, dissection
h = "3333333333332222222222228100e384080045fc002fd6d70000f21180d40a2a00010a2a0002084b084b001b00004002000f000001000300010001020002001000731cd7c5"
gtp = Ether(h.decode('hex'))
gtp.gtp_type == 2

= GTPV2ModifyBearerRequest, dissection
h = "3333333333332222222222228100a384080045b8004300000000fc1185350a2a00010a2a00027a76084b002f6c344822002392e9e1143652540052000100065d00120049000100055700090080000010927f000002ac79a28e"
gtp = Ether(h.decode('hex'))
gtp.gtp_type == 34

= IE_IMSI, dissection
h = "3333333333332222222222228100a384080045b800ed00000000fc1193430a2a00010a2a00027f61084b00d91c47482000cd00000000661759000100080002081132547600004b000800000000000001e24056000d001832f420303932f4200001e2405300030032f4205200010006570009008a000010927f0000025700090187000010927f00000247001a00196161616161616161616161616161616161616161616161616163000100014f000500017f0000034d0004000808000048000800000017000000a4105d002c0049000100235700090385000010927f00000250001600580700000000000000000000000000000000000000007200020040005311004c"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[0]
ie.IMSI == "2080112345670000"

= IE_IMSI, basic instantiation
ie = gtp_v2.IE_IMSI(ietype='IMSI', length=8, IMSI='2080112345670000')
ie.ietype == 1 and ie.IMSI == '2080112345670000'

= IE_Cause, dissection
h = "3333333333332222222222228100838408004588004a00000000fd1193160a2a00010a2a0002084b824600366a744823002a45e679235ea151000200020010005d001800490001006c0200020010005700090081000010927f000002558d3b69"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[0]
ie.Cause == 16

= IE_Cause, basic instantiation
ie = gtp_v2.IE_Cause(
    ietype='Cause', length=2, Cause='Request Accepted', PCE=1, BCE=0, CS=0)
ie.ietype == 2 and ie.Cause == 16 and ie.PCE == 1 and ie.BCE == 0 and ie.CS == 0

= IE_Cause, basic instantiation 2
ie = gtp_v2.IE_Cause(
    ietype='Cause', length=2, Cause='Request Accepted', PCE=0, BCE=1, CS=0)
ie.ietype == 2 and ie.Cause == 16 and ie.PCE == 0 and ie.BCE == 1 and ie.CS == 0

= IE_Cause, basic instantiation 3
ie = gtp_v2.IE_Cause(
    ietype='Cause', length=2, Cause='Request Accepted', PCE=0, BCE=0, CS=1)
ie.ietype == 2 and ie.Cause == 16 and ie.PCE == 0 and ie.BCE == 0 and ie.CS == 1

= IE_RecoveryRestart, dissection
h = "3333333333332222222222228100838408004588002937dd0000fd1115490a2a00010a2a0002084b084b00152d0e400100095e4b1f00030001000daa000000003f1f382f"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[0]
ie.ietype == 3 and ie.restart_counter == 13

= IE_RecoveryRestart, basic instantiation
ie = gtp_v2.IE_RecoveryRestart(
    ietype='Recovery Restart', length=1, restart_counter=17)
ie.ietype == 3 and ie.restart_counter == 17

= IE_APN, dissection
h = "3333333333332222222222228100a384080045b800ed00000000fc1193430a2a00010a2a00027f61084b00d91c47482000cd140339f4d99f66000100080002081132547600004b000800000000000001e24056000d001832f420303932f4200001e2405300030032f4205200010006570009008a000010927f0000025700090187000010927f00000247001a00196161616161616161616161616161616161616161616161616163000100014f000500017f0000034d0004000808000048000800000017000000a4105d002c0049000100e55700090385000010927f00000250001600580700000000000000000000000000000000000000007200020014005311004c"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[7]
ie.APN == 'aaaaaaaaaaaaaaaaaaaaaaaaa'

= IE_APN, basic instantiation
ie = gtp_v2.IE_APN(ietype='APN', length=26, APN='aaaaaaaaaaaaaaaaaaaaaaaaa')
ie.ietype == 71 and ie.APN == 'aaaaaaaaaaaaaaaaaaaaaaaaa'

= IE_AMBR, dissection
h = "3333333333332222222222228100a384080045b800ed00000000fc1193430a2a00010a2a00027f61084b00d91c47482000cd140339f4d99f66000100080002081132547600004b000800000000000001e24056000d001832f420303932f4200001e2405300030032f4205200010006570009008a000010927f0000025700090187000010927f00000247001a00196161616161616161616161616161616161616161616161616163000100014f000500017f0000034d0004000808000048000800000017000000a4105d002c0049000100e55700090385000010927f00000250001600580700000000000000000000000000000000000000007200020014005311004c"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[11]
ie.AMBR_Uplink == 5888 and ie.AMBR_Downlink == 42000

= IE_AMBR, basic instantiation
ie = gtp_v2.IE_AMBR(
    ietype='AMBR', length=8, AMBR_Uplink=5888, AMBR_Downlink=42000)
ie.ietype == 72 and ie.AMBR_Uplink == 5888 and ie.AMBR_Downlink == 42000

= IE_EPSBearerID, dissection
h = "3333333333332222222222228100838408004580006d00000000f31180d20a2a00010a2a0002084b85930059e49a4823004d55819f6500ede7000200020010004c000600111111111111490001003248000800000061a8000249f07f000100005d001300490001000b0200020010005e00040039004f454a0004007f00000436f73a63"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[2]
ie.EBI == 50

= IE_EPSBearerID, basic instantiation
ie = gtp_v2.IE_EPSBearerID(ietype='EPS Bearer ID', length=1, EBI=50)
ie.ietype == 73 and ie.EBI == 50

= IE_IPv4, dissection
h = "3333333333332222222222228100838408004580006d00000000f31180d20a2a00010a2a0002084b85930059e49a4823004d84530d5a4cdee2000200020010004c00060011111111111149000100b248000800000061a8000249f07f000100005d00130049000100da0200020010005e00040039004f454a0004007f00000436f73a63"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[6]
ie.address == '127.0.0.4'

= IE_IPv4, basic instantiation
ie = gtp_v2.IE_IPv4(ietype='IPv4', length=4, address='127.0.0.4')
ie.ietype == 74 and ie.address == '127.0.0.4'

= IE_MEI, dissection
h = "3333333333332222222222228100a384080045b800ed00000000fc1193430a2a00010a2a00027f61084b00d91c47482000cd140339f4d99f66000100080002081132547600004b000800000000000001e24056000d001832f420303932f4200001e2405300030032f4205200010006570009008a000010927f0000025700090187000010927f00000247001a00196161616161616161616161616161616161616161616161616163000100014f000500017f0000034d0004000808000048000800000017000000a4105d002c0049000100e55700090385000010927f00000250001600580700000000000000000000000000000000000000007200020014005311004c"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[1]
ie.MEI == 123456

= IE_MEI, basic instantiation
ie = gtp_v2.IE_MEI(ietype='MEI', length=1, MEI=123456)
ie.ietype == 75 and ie.MEI == 123456

= IE_MSISDN, dissection
h = "3333333333332222222222228100838408004580006d00000000f31180d20a2a00010a2a0002084b85930059e49a4823004d55819f6500ede7000200020010004c000600111111111111490001003248000800000061a8000249f07f000100005d001300490001000b0200020010005e00040039004f454a0004007f00000436f73a63"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[1]
ie.digits == '111111111111'

= IE_MSISDN, basic instantiation
ie = gtp_v2.IE_MSISDN(ietype='MSISDN', length=6, digits='111111111111')
ie.ietype == 76 and ie.digits == '111111111111'

= IE_Indication, dissection
h = "3333333333332222222222228100a384080045b800ed00000000fc1193430a2a00010a2a00027f61084b00d91c47482000cd140339f4d99f66000100080002081132547600004b000800000000000001e24056000d001832f420303932f4200001e2405300030032f4205200010006570009008a000010927f0000025700090187000010927f00000247001a00196161616161616161616161616161616161616161616161616163000100014f000500017f0000034d0004000808000048000800000017000000a4105d002c0049000100e55700090385000010927f00000250001600580700000000000000000000000000000000000000007200020014005311004c"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[10]
ie.DAF == 0 and ie.DTF == 0 and ie.PS == 1 and ie.CCRSI == 0 and ie.CPRAI == 0 and ie.PPON == 0 and ie.CLII == 0 and ie.CPSR == 0

= IE_Indication, basic instantiation
ie = gtp_v2.IE_Indication(ietype='Indication', length=8, PS=1, CPRAI=1)
ie.ietype == 77 and ie.PS == 1 and ie.CPRAI == 1

= IE_Indication, basic instantiation 2
ie = gtp_v2.IE_Indication(ietype='Indication', length=8, DTF=1, PPSI=1)
ie.ietype == 77 and ie.DTF == 1 and ie.PPSI == 1

= IE_PCO, dissection
h = "333333333333222222222222810083840800458800a500000000fd1183bb0a2a00010a2a0002084b76a00091cf0b48210085bd574af24c68e300020002001000570009008b000010927f0000025700090187000010927f0000024f000500017f0000037f000100004e00220080000d040a2a0003000d040a2a00038021100300001081060a2a000483060a2a00045d00250049000100660200020010005700090081000010927f0000025700090285000010927f000002dd9f22c6"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[5]
ie.Protocols[0].address == '10.42.0.3'

= IE_PCO, basic instantiation
ie = gtp_v2.IE_PCO(ietype='Protocol Configuration Options', length=8, Extension=1, PPP=3, Protocols=[
                   gtp_v2.PCO_DNS_Server_IPv4(type='DNS Server IPv4 Address Request', length=4, address='10.42.0.3')])
ie.Extension == 1 and ie.PPP == 3 and ie.Protocols[0].address == '10.42.0.3'

= IE_PAA, dissection
h = "3333333333332222222222228100a384080045b800ed00000000fc1193430a2a00010a2a00027f61084b00d91c47482000cd140339f4d99f66000100080002081132547600004b000800000000000001e24056000d001832f420303932f4200001e2405300030032f4205200010006570009008a000010927f0000025700090187000010927f00000247001a00196161616161616161616161616161616161616161616161616163000100014f000500017f0000034d0004000808000048000800000017000000a4105d002c0049000100e55700090385000010927f00000250001600580700000000000000000000000000000000000000007200020014005311004c"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[9]
ie.PDN_type == 1 and ie.ipv4 == '127.0.0.3'

= IE_PAA, basic instantiation
ie = gtp_v2.IE_PAA(ietype='PAA', length=5, PDN_type='IPv4', ipv4='127.0.0.3')
ie.ietype == 79 and ie.PDN_type == 1 and ie.ipv4 == '127.0.0.3'

= IE_Bearer_QoS, dissection
h = "3333333333332222222222228100a384080045b800ed00000000fc1193430a2a00010a2a00027f61084b00d91c47482000cd140339f4d99f66000100080002081132547600004b000800000000000001e24056000d001832f420303932f4200001e2405300030032f4205200010006570009008a000010927f0000025700090187000010927f00000247001a00196161616161616161616161616161616161616161616161616163000100014f000500017f0000034d0004000808000048000800000017000000a4105d002c0049000100e55700090385000010927f00000250001600580700000000000000000000000000000000000000007200020014005311004c"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[12].IE_list[2]
ie.MaxBitRateForUplink == 0 and ie.MaxBitRateForDownlink == 0 and ie.QCI == 7

= IE_Bearer_QoS, basic instantiation
ie = gtp_v2.IE_Bearer_QoS(ietype='Bearer QoS', length=22, PCI=4, PriorityLevel=5, PVI=6, QCI=7,
                          MaxBitRateForUplink=1, MaxBitRateForDownlink=2, GuaranteedBitRateForUplink=3, GuaranteedBitRateForDownlink=4)
ie.ietype == 80 and ie.PCI == 4 and ie.PriorityLevel == 5 and ie.PVI == 6 and ie.QCI == 7 and ie.MaxBitRateForUplink == 1 and ie.MaxBitRateForDownlink == 2 and ie.GuaranteedBitRateForUplink == 3 and ie.GuaranteedBitRateForDownlink == 4

= IE_RAT, dissection
h = "3333333333332222222222228100a384080045b800ed00000000fc1193430a2a00010a2a00027f61084b00d91c47482000cd140339f4d99f66000100080002081132547600004b000800000000000001e24056000d001832f420303932f4200001e2405300030032f4205200010006570009008a000010927f0000025700090187000010927f00000247001a00196161616161616161616161616161616161616161616161616163000100014f000500017f0000034d0004000808000048000800000017000000a4105d002c0049000100e55700090385000010927f00000250001600580700000000000000000000000000000000000000007200020014005311004c"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[4]
ie.RAT_type == 6

= IE_RAT, basic instantiation
ie = gtp_v2.IE_RAT(ietype='RAT', length=1, RAT_type='EUTRAN')
ie.ietype == 82 and ie.RAT_type == 6

= IE_ServingNetwork, dissection
h = "3333333333332222222222228100a384080045b800ed00000000fc1193430a2a00010a2a00027f61084b00d91c47482000cd140339f4d99f66000100080002081132547600004b000800000000000001e24056000d001832f420303932f4200001e2405300030032f4205200010006570009008a000010927f0000025700090187000010927f00000247001a00196161616161616161616161616161616161616161616161616163000100014f000500017f0000034d0004000808000048000800000017000000a4105d002c0049000100e55700090385000010927f00000250001600580700000000000000000000000000000000000000007200020014005311004c"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[3]
ie.MCC == '234' and ie.MNC == '02'

= IE_ServingNetwork, basic instantiation
ie = gtp_v2.IE_ServingNetwork(
    ietype='Serving Network', length=3, MCC='234', MNC='02')
ie.ietype == 83 and ie.MCC == '234' and ie.MNC == '02'

= IE_ULI, dissection
h = "3333333333332222222222228100a384080045b800ed00000000fc1193430a2a00010a2a00027f61084b00d91c47482000cd140339f4d99f66000100080002081132547600004b000800000000000001e24056000d001832f420303932f4200001e2405300030032f4205200010006570009008a000010927f0000025700090187000010927f00000247001a00196161616161616161616161616161616161616161616161616163000100014f000500017f0000034d0004000808000048000800000017000000a4105d002c0049000100e55700090385000010927f00000250001600580700000000000000000000000000000000000000007200020014005311004c"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[2]
ie.TAI_Present == 1 and ie.ECGI_Present == 1 and ie.TAI.MCC == '234' and ie.TAI.MNC == '02' and ie.TAI.TAC == 12345 and ie.ECGI.MCC == '234' and ie.ECGI.MNC == '02' and ie.ECGI.ECI == 123456

= IE_ULI, basic instantiation
ie = gtp_v2.IE_ULI(ietype='ULI', length=13, LAI_Present=0, ECGI_Present=1, TAI_Present=1, RAI_Present=0, SAI_Present=0,
                   CGI_Present=0, TAI=gtp_v2.ULI_TAI(MCC='234', MNC='02', TAC=12345), ECGI=gtp_v2.ULI_ECGI(MCC='234', MNC='02', ECI=123456))
ie.ietype == 86 and ie.LAI_Present == 0 and ie.ECGI_Present == 1 and ie.TAI_Present == 1 and ie.RAI_Present == 0 and ie.SAI_Present == 0 and ie.CGI_Present == 0 and ie.TAI.MCC == '234' and ie.TAI.MNC == '02' and ie.TAI.TAC == 12345 and ie.ECGI.MCC == '234' and ie.ECGI.MNC == '02' and ie.ECGI.ECI == 123456

= IE_FTEID, dissection
h = "3333333333332222222222228100a384080045b800ed00000000fc1193430a2a00010a2a00027f61084b00d91c47482000cd140339f4d99f66000100080002081132547600004b000800000000000001e24056000d001832f420303932f4200001e2405300030032f4205200010006570009008a000010927f0000025700090187000010927f00000247001a00196161616161616161616161616161616161616161616161616163000100014f000500017f0000034d0004000808000048000800000017000000a4105d002c0049000100e55700090385000010927f00000250001600580700000000000000000000000000000000000000007200020014005311004c"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[5]
ie.GRE_Key == 4242 and ie.ipv4 == '127.0.0.2'

= IE_FTEID, basic instantiation
ie = gtp_v2.IE_FTEID(ietype='F-TEID', length=9, ipv4_present=1,
                     InterfaceType=10, GRE_Key=0x1092, ipv4='127.0.0.2')
ie.ietype == 87 and ie.ipv4_present == 1 and ie.InterfaceType == 10 and ie.GRE_Key == 0x1092 and ie.ipv4 == '127.0.0.2'

= IE_BearerContext, dissection
h = "3333333333332222222222228100a384080045b800ed00000000fc1193430a2a00010a2a00027f61084b00d91c47482000cd140339f4d99f66000100080002081132547600004b000800000000000001e24056000d001832f420303932f4200001e2405300030032f4205200010006570009008a000010927f0000025700090187000010927f00000247001a00196161616161616161616161616161616161616161616161616163000100014f000500017f0000034d0004000808000048000800000017000000a4105d002c0049000100e55700090385000010927f00000250001600580700000000000000000000000000000000000000007200020014005311004c"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[12]
len(ie.IE_list) == 3 and ie.IE_list[0].ietype == 73 and ie.IE_list[0].EBI == 229 and ie.IE_list[
    1].ietype == 87 and ie.IE_list[1].ipv4 == '127.0.0.2' and ie.IE_list[2].ietype == 80 and ie.IE_list[2].QCI == 7

= IE_BearerContext, basic instantiation
ie = gtp_v2.IE_BearerContext(ietype='Bearer Context', length=44, IE_list=[
                             gtp_v2.IE_EPSBearerID(ietype='EPS Bearer ID', length=1, EBI=229)])
ie.ietype == 93 and len(ie.IE_list) == 1 and ie.IE_list[
    0].ietype == 73 and ie.IE_list[0].EBI == 229

= IE_ChargingID, dissection
h = "3333333333332222222222228100838408004580006d00000000f31180d20a2a00010a2a0002084b85930059e49a4823004da0316b4d96ac2c000200020010004c00060011111111111149000100c348000800000061a8000249f07f000100005d001300490001003f0200020010005e00040039004f454a0004007f00000436f73a63"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[5].IE_list[2]
ie.ChargingID == 956321605

= IE_ChargingID, basic instantiation
ie = gtp_v2.IE_ChargingID(ietype='Charging ID', length=4, ChargingID=956321605)
ie.ietype == 94 and ie.ChargingID == 956321605

= IE_ChargingCharacteristics, dissection
h = "3333333333332222222222228100a384080045b8011800000000fc1193150a2a00010a2a00027be5084b010444c4482000f82fd783953790a2000100080002081132547600004c0006001111111111114b000800000000000001e24056000d001832f420303932f4200001e2405300030032f4205200010006570009008a000010927f0000025700090187000010927f00000247001a001961616161616161616161616161616161616161616161616161800001000063000100014f000500017f0000034d000400000800007f00010000480008000000c3500002e6304e001a008080211001000010810600000000830600000000000d00000a005d001f00490001000750001600190700000000000000000000000000000000000000007200020014005f0002000a008e80b09f"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[18]
ie.ChargingCharacteristric == 0xa00

= IE_ChargingCharacteristics, basic instantiation
ie = gtp_v2.IE_ChargingCharacteristics(
    ietype='Charging Characteristics', length=2, ChargingCharacteristric=0xa00)
ie.ietype == 95 and ie.ChargingCharacteristric == 0xa00

= IE_PDN_type, dissection
h = "3333333333332222222222228100a384080045b800ed00000000fc1193430a2a00010a2a00027f61084b00d91c47482000cd140339f4d99f66000100080002081132547600004b000800000000000001e24056000d001832f420303932f4200001e2405300030032f4205200010006570009008a000010927f0000025700090187000010927f00000247001a00196161616161616161616161616161616161616161616161616163000100014f000500017f0000034d0004000808000048000800000017000000a4105d002c0049000100e55700090385000010927f00000250001600580700000000000000000000000000000000000000007200020014005311004c"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[8]
ie.PDN_type == 1

= IE_PDN_type, basic instantiation
ie = gtp_v2.IE_PDN_type(ietype='PDN Type', length=1, PDN_type='IPv4')
ie.ietype == 99 and ie.PDN_type == 1

= IE_UE_Timezone, dissection
h = "3333333333332222222222228100a384080045b800ed00000000fc1193430a2a00010a2a00027f61084b00d91c47482000cd140339f4d99f66000100080002081132547600004b000800000000000001e24056000d001832f420303932f4200001e2405300030032f4205200010006570009008a000010927f0000025700090187000010927f00000247001a00196161616161616161616161616161616161616161616161616163000100014f000500017f0000034d0004000808000048000800000017000000a4105d002c0049000100e55700090385000010927f00000250001600580700000000000000000000000000000000000000007200020014005311004c"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[13]
ie.Timezone == 20 and ie.DST == 0

= IE_UE_Timezone, basic instantiation
ie = gtp_v2.IE_UE_Timezone(ietype='UE Time zone', length=2, Timezone=20, DST=0)
ie.ietype == 114 and ie.Timezone == 20 and ie.DST == 0

= IE_UE_Timezone, basic instantiation
ie = gtp_v2.IE_UE_Timezone(ietype='UE Time zone', length=2, Timezone=20, DST=1)
ie.ietype == 114 and ie.Timezone == 20 and ie.DST == 1

= IE_APN_Restriction, dissection
h = "3333333333332222222222228100838408004580006d00000000f31180d20a2a00010a2a0002084b85930059e49a4823004d55819f6500ede7000200020010004c000600111111111111490001003248000800000061a8000249f07f000100005d001300490001000b0200020010005e00040039004f454a0004007f00000436f73a63"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[4]
ie.APN_Restriction == 0

= IE_APN_Restriction, basic instantiation
ie = gtp_v2.IE_APN_Restriction(
    ietype='APN Restriction', length=1, APN_Restriction=0)
ie.ietype == 127 and ie.APN_Restriction == 0

= IE_SelectionMode, dissection
h = "3333333333332222222222228100a384080045b8011800000000fc1193150a2a00010a2a00027be5084b010444c4482000f8093ca4cc47fa69000100080002081132547600004c0006001111111111114b000800000000000001e24056000d001832f420303932f4200001e2405300030032f4205200010006570009008a000010927f0000025700090187000010927f00000247001a001961616161616161616161616161616161616161616161616161800001000063000100014f000500017f0000034d000400000800007f00010000480008000000c3500002e6304e001a008080211001000010810600000000830600000000000d00000a005d001f00490001004850001600190700000000000000000000000000000000000000007200020014005f0002000a008e80b09f"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[9]
ie.SelectionMode == 0

= IE_SelectionMode, basic instantiation
ie = gtp_v2.IE_SelectionMode(
    ietype='Selection Mode', length=1, SelectionMode=4)
ie.ietype == 128 and ie.SelectionMode == 4

= IE_MMBR, dissection
h = "3333333333332222222222228100838408004580014c97af0000f011830e0a2a00010a2a000282d5084b013876a74820012c29694a667f4a0b000100080002081132547600004c0006001111111111114b000800000000000001e24056000f000632f42030391a8532f42030391a855300030032f420520001000157001900c6000010927f0000020000000000000000000000000000fe8247001a001961616161616161616161616161616161616161616161616161800001000063000100014f000500017f0000034d000400000000007f000100004800080000001640000052084e00200080c02306010000060000802110010000108106000000008306000000000005005d003c00490001006057001902c4000010927f0000020000000000000000000000000000fe825000160029080000000000000000000000000000000000000000720002006e005f0002000a00a10008000000164000005208e4701ad2"
gtp = Ether(h.decode('hex'))
ie = gtp.IE_list[18]
ie.uplink_rate == 5696 and ie.downlink_rate == 21000

= IE_MMBR, basic instantiation
ie = gtp_v2.IE_MMBR(ietype='Max MBR/APN-AMBR (MMBR)',
                    length=8, uplink_rate=5696, downlink_rate=21000)
ie.ietype == 161 and ie.uplink_rate == 5696 and ie.downlink_rate == 21000
