#! /usr/bin/env python

from .pids_s1AndS2 import *
from .pids_s9 import *
from .services import *
from scapy.packet import Packet, bind_layers, bind_bottom_up
from scapy.fields import XByteEnumField


class OBD(Packet):
    services = {
        0x01: 'CurrentDataRequest',
        0x02: 'FreezeFrameDataRequest',
        0x03: 'DiagnosticTroubleCodesRequest',
        0x04: 'ClearDiagnosticTroubleCodesRequest',
        0x05: 'OxygenSensorMonitoring_noCanRequest',
        0x06: 'OxygenSensorMonitoring_canOnlyRequest',
        0x07: 'PendingDiagnosticTroubleCodesRequest',
        0x08: 'ControlOperationRequest',
        0x09: 'VehicleInformationRequest',
        0x0A: 'PermanentDiagnosticTroubleCodesRequest',

        0x41: 'CurrentDataResponse',
        0x42: 'FreezeFrameDataResponse',
        0x43: 'DiagnosticTroubleCodesResponse',
        0x44: 'ClearDiagnosticTroubleCodesResponse',
        0x45: 'OxygenSensorMonitoring_noCanResponse',
        0x46: 'OxygenSensorMonitoring_canOnlyResponse',
        0x47: 'PendingDiagnosticTroubleCodesResponse',
        0x48: 'ControlOperationResponse',
        0x49: 'VehicleInformationResponse',
        0x4A: 'PermanentDiagnosticTroubleCodesResponse'}

    name = "On-board diagnostics"

    fields_desc = [
        XByteEnumField('service', 0, services)
    ]

    def hashret(self):
        val = self.service & ~0x40
        if hasattr(self, 'pid'):
            val += self.pid

        return val

    def answers(self, other):
        """DEV: true if self is an answer from other"""
        if other.__class__ == self.__class__:
            if hasattr(other, 'pid') and hasattr(self, 'pid'):
                if other.pid != self.pid:
                    return 0

            return (other.service + 0x40) == self.service
        return 0


# Service Bindings


bind_layers(OBD, Service01, service=0x01)
bind_layers(OBD, Service02, service=0x02)
bind_layers(OBD, Service03, service=0x03)
bind_layers(OBD, Service04, service=0x04)
bind_layers(OBD, Service05, service=0x05)
bind_layers(OBD, Service06, service=0x06)
bind_layers(OBD, Service07, service=0x07)
bind_layers(OBD, Service09, service=0x09)
bind_layers(OBD, Service0A, service=0x0A)

bind_bottom_up(OBD, Service01, service=0x41)
bind_bottom_up(OBD, Service02, service=0x42)
bind_bottom_up(OBD, Service03, service=0x43)
bind_bottom_up(OBD, Service04, service=0x44)
bind_bottom_up(OBD, Service05, service=0x45)
bind_bottom_up(OBD, Service06, service=0x46)
bind_bottom_up(OBD, Service07, service=0x47)
bind_bottom_up(OBD, Service09, service=0x49)
bind_bottom_up(OBD, Service0A, service=0x4A)


# PID Bindings

# Service 1

bind_layers(Service01, Pid00_S1AndS2, pid=0x00)
bind_layers(Service01, Pid01_S1AndS2, pid=0x01)
bind_layers(Service01, Pid02_S1AndS2, pid=0x02)
bind_layers(Service01, Pid03_S1AndS2, pid=0x03)
bind_layers(Service01, Pid04_S1AndS2, pid=0x04)
bind_layers(Service01, Pid05_S1AndS2, pid=0x05)
bind_layers(Service01, Pid06_S1AndS2, pid=0x06)
bind_layers(Service01, Pid07_S1AndS2, pid=0x07)
bind_layers(Service01, Pid08_S1AndS2, pid=0x08)
bind_layers(Service01, Pid09_S1AndS2, pid=0x09)
bind_layers(Service01, Pid0A_S1AndS2, pid=0x0A)
bind_layers(Service01, Pid0B_S1AndS2, pid=0x0B)
bind_layers(Service01, Pid0C_S1AndS2, pid=0x0C)
bind_layers(Service01, Pid0D_S1AndS2, pid=0x0D)
bind_layers(Service01, Pid0E_S1AndS2, pid=0x0E)
bind_layers(Service01, Pid0F_S1AndS2, pid=0x0F)
bind_layers(Service01, Pid10_S1AndS2, pid=0x10)
bind_layers(Service01, Pid11_S1AndS2, pid=0x11)
bind_layers(Service01, Pid12_S1AndS2, pid=0x12)
bind_layers(Service01, Pid13_S1AndS2, pid=0x13)
bind_layers(Service01, Pid14_S1AndS2, pid=0x14)
bind_layers(Service01, Pid15_S1AndS2, pid=0x15)
bind_layers(Service01, Pid16_S1AndS2, pid=0x16)
bind_layers(Service01, Pid17_S1AndS2, pid=0x17)
bind_layers(Service01, Pid18_S1AndS2, pid=0x18)
bind_layers(Service01, Pid19_S1AndS2, pid=0x19)
bind_layers(Service01, Pid1A_S1AndS2, pid=0x1A)
bind_layers(Service01, Pid1B_S1AndS2, pid=0x1B)
bind_layers(Service01, Pid1C_S1AndS2, pid=0x1C)
bind_layers(Service01, Pid1D_S1AndS2, pid=0x1D)
bind_layers(Service01, Pid1E_S1AndS2, pid=0x1E)
bind_layers(Service01, Pid1F_S1AndS2, pid=0x1F)
bind_layers(Service01, Pid20_S1AndS2, pid=0x20)
bind_layers(Service01, Pid21_S1AndS2, pid=0x21)
bind_layers(Service01, Pid22_S1AndS2, pid=0x22)
bind_layers(Service01, Pid23_S1AndS2, pid=0x23)
bind_layers(Service01, Pid24_S1AndS2, pid=0x24)
bind_layers(Service01, Pid25_S1AndS2, pid=0x25)
bind_layers(Service01, Pid26_S1AndS2, pid=0x26)
bind_layers(Service01, Pid27_S1AndS2, pid=0x27)
bind_layers(Service01, Pid28_S1AndS2, pid=0x28)
bind_layers(Service01, Pid29_S1AndS2, pid=0x29)
bind_layers(Service01, Pid2A_S1AndS2, pid=0x2A)
bind_layers(Service01, Pid2B_S1AndS2, pid=0x2B)
bind_layers(Service01, Pid2C_S1AndS2, pid=0x2C)
bind_layers(Service01, Pid2D_S1AndS2, pid=0x2D)
bind_layers(Service01, Pid2E_S1AndS2, pid=0x2E)
bind_layers(Service01, Pid2F_S1AndS2, pid=0x2F)
bind_layers(Service01, Pid30_S1AndS2, pid=0x30)
bind_layers(Service01, Pid31_S1AndS2, pid=0x31)
bind_layers(Service01, Pid32_S1AndS2, pid=0x32)
bind_layers(Service01, Pid33_S1AndS2, pid=0x33)
bind_layers(Service01, Pid34_S1AndS2, pid=0x34)
bind_layers(Service01, Pid35_S1AndS2, pid=0x35)
bind_layers(Service01, Pid36_S1AndS2, pid=0x36)
bind_layers(Service01, Pid37_S1AndS2, pid=0x37)
bind_layers(Service01, Pid38_S1AndS2, pid=0x38)
bind_layers(Service01, Pid39_S1AndS2, pid=0x39)
bind_layers(Service01, Pid3A_S1AndS2, pid=0x3A)
bind_layers(Service01, Pid3B_S1AndS2, pid=0x3B)
bind_layers(Service01, Pid3C_S1AndS2, pid=0x3C)
bind_layers(Service01, Pid3D_S1AndS2, pid=0x3D)
bind_layers(Service01, Pid3E_S1AndS2, pid=0x3E)
bind_layers(Service01, Pid3F_S1AndS2, pid=0x3F)
bind_layers(Service01, Pid40_S1AndS2, pid=0x40)
bind_layers(Service01, Pid41_S1AndS2, pid=0x41)
bind_layers(Service01, Pid42_S1AndS2, pid=0x42)
bind_layers(Service01, Pid43_S1AndS2, pid=0x43)
bind_layers(Service01, Pid44_S1AndS2, pid=0x44)
bind_layers(Service01, Pid45_S1AndS2, pid=0x45)
bind_layers(Service01, Pid46_S1AndS2, pid=0x46)
bind_layers(Service01, Pid47_S1AndS2, pid=0x47)
bind_layers(Service01, Pid48_S1AndS2, pid=0x48)
bind_layers(Service01, Pid49_S1AndS2, pid=0x49)
bind_layers(Service01, Pid4A_S1AndS2, pid=0x4A)
bind_layers(Service01, Pid4B_S1AndS2, pid=0x4B)
bind_layers(Service01, Pid4C_S1AndS2, pid=0x4C)
bind_layers(Service01, Pid4D_S1AndS2, pid=0x4D)
bind_layers(Service01, Pid4E_S1AndS2, pid=0x4E)
bind_layers(Service01, Pid4F_S1AndS2, pid=0x4F)
bind_layers(Service01, Pid50_S1AndS2, pid=0x50)
bind_layers(Service01, Pid51_S1AndS2, pid=0x51)
bind_layers(Service01, Pid52_S1AndS2, pid=0x52)
bind_layers(Service01, Pid53_S1AndS2, pid=0x53)
bind_layers(Service01, Pid54_S1AndS2, pid=0x54)
bind_layers(Service01, Pid55_S1AndS2, pid=0x55)
bind_layers(Service01, Pid56_S1AndS2, pid=0x56)
bind_layers(Service01, Pid57_S1AndS2, pid=0x57)
bind_layers(Service01, Pid58_S1AndS2, pid=0x58)
bind_layers(Service01, Pid59_S1AndS2, pid=0x59)
bind_layers(Service01, Pid5A_S1AndS2, pid=0x5A)
bind_layers(Service01, Pid5B_S1AndS2, pid=0x5B)
bind_layers(Service01, Pid5C_S1AndS2, pid=0x5C)
bind_layers(Service01, Pid5D_S1AndS2, pid=0x5D)
bind_layers(Service01, Pid5E_S1AndS2, pid=0x5E)
bind_layers(Service01, Pid5F_S1AndS2, pid=0x5F)
bind_layers(Service01, Pid60_S1AndS2, pid=0x60)
bind_layers(Service01, Pid61_S1AndS2, pid=0x61)
bind_layers(Service01, Pid62_S1AndS2, pid=0x62)
bind_layers(Service01, Pid63_S1AndS2, pid=0x63)
bind_layers(Service01, Pid64_S1AndS2, pid=0x64)
bind_layers(Service01, Pid65_S1AndS2, pid=0x65)
bind_layers(Service01, Pid66_S1AndS2, pid=0x66)
bind_layers(Service01, Pid67_S1AndS2, pid=0x67)
bind_layers(Service01, Pid68_S1AndS2, pid=0x68)
bind_layers(Service01, Pid69_S1AndS2, pid=0x69)
bind_layers(Service01, Pid6A_S1AndS2, pid=0x6A)
bind_layers(Service01, Pid6B_S1AndS2, pid=0x6B)
bind_layers(Service01, Pid6C_S1AndS2, pid=0x6C)
bind_layers(Service01, Pid6D_S1AndS2, pid=0x6D)
bind_layers(Service01, Pid6E_S1AndS2, pid=0x6E)
bind_layers(Service01, Pid6F_S1AndS2, pid=0x6F)
bind_layers(Service01, Pid70_S1AndS2, pid=0x70)
bind_layers(Service01, Pid71_S1AndS2, pid=0x71)
bind_layers(Service01, Pid72_S1AndS2, pid=0x72)
bind_layers(Service01, Pid73_S1AndS2, pid=0x73)
bind_layers(Service01, Pid74_S1AndS2, pid=0x74)
bind_layers(Service01, Pid75_S1AndS2, pid=0x75)
bind_layers(Service01, Pid76_S1AndS2, pid=0x76)
bind_layers(Service01, Pid77_S1AndS2, pid=0x77)
bind_layers(Service01, Pid78_S1AndS2, pid=0x78)
bind_layers(Service01, Pid79_S1AndS2, pid=0x79)
bind_layers(Service01, Pid7A_S1AndS2, pid=0x7A)
bind_layers(Service01, Pid7B_S1AndS2, pid=0x7B)
bind_layers(Service01, Pid7C_S1AndS2, pid=0x7C)
bind_layers(Service01, Pid7D_S1AndS2, pid=0x7D)
bind_layers(Service01, Pid7E_S1AndS2, pid=0x7E)
bind_layers(Service01, Pid7F_S1AndS2, pid=0x7F)
bind_layers(Service01, Pid80_S1AndS2, pid=0x80)
bind_layers(Service01, Pid81_S1AndS2, pid=0x81)
bind_layers(Service01, Pid82_S1AndS2, pid=0x82)
bind_layers(Service01, Pid83_S1AndS2, pid=0x83)
bind_layers(Service01, Pid84_S1AndS2, pid=0x84)
bind_layers(Service01, Pid85_S1AndS2, pid=0x85)
bind_layers(Service01, Pid86_S1AndS2, pid=0x86)
bind_layers(Service01, Pid87_S1AndS2, pid=0x87)
bind_layers(Service01, Pid88_S1AndS2, pid=0x88)
bind_layers(Service01, Pid89_S1AndS2, pid=0x89)
bind_layers(Service01, Pid8A_S1AndS2, pid=0x8A)
bind_layers(Service01, Pid8B_S1AndS2, pid=0x8B)
bind_layers(Service01, Pid8C_S1AndS2, pid=0x8C)
bind_layers(Service01, Pid8D_S1AndS2, pid=0x8D)
bind_layers(Service01, Pid8E_S1AndS2, pid=0x8E)
bind_layers(Service01, Pid8F_S1AndS2, pid=0x8F)
bind_layers(Service01, Pid90_S1AndS2, pid=0x90)
bind_layers(Service01, Pid91_S1AndS2, pid=0x91)
bind_layers(Service01, Pid92_S1AndS2, pid=0x92)
bind_layers(Service01, Pid93_S1AndS2, pid=0x93)
bind_layers(Service01, Pid94_S1AndS2, pid=0x94)
bind_layers(Service01, Pid98_S1AndS2, pid=0x98)
bind_layers(Service01, Pid99_S1AndS2, pid=0x99)
bind_layers(Service01, Pid9A_S1AndS2, pid=0x9A)
bind_layers(Service01, Pid9B_S1AndS2, pid=0x9B)
bind_layers(Service01, Pid9C_S1AndS2, pid=0x9C)
bind_layers(Service01, Pid9D_S1AndS2, pid=0x9D)
bind_layers(Service01, Pid9E_S1AndS2, pid=0x9E)
bind_layers(Service01, Pid9F_S1AndS2, pid=0x9F)
bind_layers(Service01, PidA0_S1AndS2, pid=0xA0)
bind_layers(Service01, PidA1_S1AndS2, pid=0xA1)
bind_layers(Service01, PidA2_S1AndS2, pid=0xA2)
bind_layers(Service01, PidA3_S1AndS2, pid=0xA3)
bind_layers(Service01, PidA4_S1AndS2, pid=0xA4)
bind_layers(Service01, PidA5_S1AndS2, pid=0xA5)
bind_layers(Service01, PidA6_S1AndS2, pid=0xA6)
bind_layers(Service01, PidC0_S1AndS2, pid=0xC0)

# Service 2

bind_layers(Service02, Pid00_S1AndS2, pid=0x00)
bind_layers(Service02, Pid01_S1AndS2, pid=0x01)
bind_layers(Service02, Pid02_S1AndS2, pid=0x02)
bind_layers(Service02, Pid03_S1AndS2, pid=0x03)
bind_layers(Service02, Pid04_S1AndS2, pid=0x04)
bind_layers(Service02, Pid05_S1AndS2, pid=0x05)
bind_layers(Service02, Pid06_S1AndS2, pid=0x06)
bind_layers(Service02, Pid07_S1AndS2, pid=0x07)
bind_layers(Service02, Pid08_S1AndS2, pid=0x08)
bind_layers(Service02, Pid09_S1AndS2, pid=0x09)
bind_layers(Service02, Pid0A_S1AndS2, pid=0x0A)
bind_layers(Service02, Pid0B_S1AndS2, pid=0x0B)
bind_layers(Service02, Pid0C_S1AndS2, pid=0x0C)
bind_layers(Service02, Pid0D_S1AndS2, pid=0x0D)
bind_layers(Service02, Pid0E_S1AndS2, pid=0x0E)
bind_layers(Service02, Pid0F_S1AndS2, pid=0x0F)
bind_layers(Service02, Pid10_S1AndS2, pid=0x10)
bind_layers(Service02, Pid11_S1AndS2, pid=0x11)
bind_layers(Service02, Pid12_S1AndS2, pid=0x12)
bind_layers(Service02, Pid13_S1AndS2, pid=0x13)
bind_layers(Service02, Pid14_S1AndS2, pid=0x14)
bind_layers(Service02, Pid15_S1AndS2, pid=0x15)
bind_layers(Service02, Pid16_S1AndS2, pid=0x16)
bind_layers(Service02, Pid17_S1AndS2, pid=0x17)
bind_layers(Service02, Pid18_S1AndS2, pid=0x18)
bind_layers(Service02, Pid19_S1AndS2, pid=0x19)
bind_layers(Service02, Pid1A_S1AndS2, pid=0x1A)
bind_layers(Service02, Pid1B_S1AndS2, pid=0x1B)
bind_layers(Service02, Pid1C_S1AndS2, pid=0x1C)
bind_layers(Service02, Pid1D_S1AndS2, pid=0x1D)
bind_layers(Service02, Pid1E_S1AndS2, pid=0x1E)
bind_layers(Service02, Pid1F_S1AndS2, pid=0x1F)
bind_layers(Service02, Pid20_S1AndS2, pid=0x20)
bind_layers(Service02, Pid21_S1AndS2, pid=0x21)
bind_layers(Service02, Pid22_S1AndS2, pid=0x22)
bind_layers(Service02, Pid23_S1AndS2, pid=0x23)
bind_layers(Service02, Pid24_S1AndS2, pid=0x24)
bind_layers(Service02, Pid25_S1AndS2, pid=0x25)
bind_layers(Service02, Pid26_S1AndS2, pid=0x26)
bind_layers(Service02, Pid27_S1AndS2, pid=0x27)
bind_layers(Service02, Pid28_S1AndS2, pid=0x28)
bind_layers(Service02, Pid29_S1AndS2, pid=0x29)
bind_layers(Service02, Pid2A_S1AndS2, pid=0x2A)
bind_layers(Service02, Pid2B_S1AndS2, pid=0x2B)
bind_layers(Service02, Pid2C_S1AndS2, pid=0x2C)
bind_layers(Service02, Pid2D_S1AndS2, pid=0x2D)
bind_layers(Service02, Pid2E_S1AndS2, pid=0x2E)
bind_layers(Service02, Pid2F_S1AndS2, pid=0x2F)
bind_layers(Service02, Pid30_S1AndS2, pid=0x30)
bind_layers(Service02, Pid31_S1AndS2, pid=0x31)
bind_layers(Service02, Pid32_S1AndS2, pid=0x32)
bind_layers(Service02, Pid33_S1AndS2, pid=0x33)
bind_layers(Service02, Pid34_S1AndS2, pid=0x34)
bind_layers(Service02, Pid35_S1AndS2, pid=0x35)
bind_layers(Service02, Pid36_S1AndS2, pid=0x36)
bind_layers(Service02, Pid37_S1AndS2, pid=0x37)
bind_layers(Service02, Pid38_S1AndS2, pid=0x38)
bind_layers(Service02, Pid39_S1AndS2, pid=0x39)
bind_layers(Service02, Pid3A_S1AndS2, pid=0x3A)
bind_layers(Service02, Pid3B_S1AndS2, pid=0x3B)
bind_layers(Service02, Pid3C_S1AndS2, pid=0x3C)
bind_layers(Service02, Pid3D_S1AndS2, pid=0x3D)
bind_layers(Service02, Pid3E_S1AndS2, pid=0x3E)
bind_layers(Service02, Pid3F_S1AndS2, pid=0x3F)
bind_layers(Service02, Pid40_S1AndS2, pid=0x40)
bind_layers(Service02, Pid41_S1AndS2, pid=0x41)
bind_layers(Service02, Pid42_S1AndS2, pid=0x42)
bind_layers(Service02, Pid43_S1AndS2, pid=0x43)
bind_layers(Service02, Pid44_S1AndS2, pid=0x44)
bind_layers(Service02, Pid45_S1AndS2, pid=0x45)
bind_layers(Service02, Pid46_S1AndS2, pid=0x46)
bind_layers(Service02, Pid47_S1AndS2, pid=0x47)
bind_layers(Service02, Pid48_S1AndS2, pid=0x48)
bind_layers(Service02, Pid49_S1AndS2, pid=0x49)
bind_layers(Service02, Pid4A_S1AndS2, pid=0x4A)
bind_layers(Service02, Pid4B_S1AndS2, pid=0x4B)
bind_layers(Service02, Pid4C_S1AndS2, pid=0x4C)
bind_layers(Service02, Pid4D_S1AndS2, pid=0x4D)
bind_layers(Service02, Pid4E_S1AndS2, pid=0x4E)
bind_layers(Service02, Pid4F_S1AndS2, pid=0x4F)
bind_layers(Service02, Pid50_S1AndS2, pid=0x50)
bind_layers(Service02, Pid51_S1AndS2, pid=0x51)
bind_layers(Service02, Pid52_S1AndS2, pid=0x52)
bind_layers(Service02, Pid53_S1AndS2, pid=0x53)
bind_layers(Service02, Pid54_S1AndS2, pid=0x54)
bind_layers(Service02, Pid55_S1AndS2, pid=0x55)
bind_layers(Service02, Pid56_S1AndS2, pid=0x56)
bind_layers(Service02, Pid57_S1AndS2, pid=0x57)
bind_layers(Service02, Pid58_S1AndS2, pid=0x58)
bind_layers(Service02, Pid59_S1AndS2, pid=0x59)
bind_layers(Service02, Pid5A_S1AndS2, pid=0x5A)
bind_layers(Service02, Pid5B_S1AndS2, pid=0x5B)
bind_layers(Service02, Pid5C_S1AndS2, pid=0x5C)
bind_layers(Service02, Pid5D_S1AndS2, pid=0x5D)
bind_layers(Service02, Pid5E_S1AndS2, pid=0x5E)
bind_layers(Service02, Pid5F_S1AndS2, pid=0x5F)
bind_layers(Service02, Pid60_S1AndS2, pid=0x60)
bind_layers(Service02, Pid61_S1AndS2, pid=0x61)
bind_layers(Service02, Pid62_S1AndS2, pid=0x62)
bind_layers(Service02, Pid63_S1AndS2, pid=0x63)
bind_layers(Service02, Pid64_S1AndS2, pid=0x64)
bind_layers(Service02, Pid65_S1AndS2, pid=0x65)
bind_layers(Service02, Pid66_S1AndS2, pid=0x66)
bind_layers(Service02, Pid67_S1AndS2, pid=0x67)
bind_layers(Service02, Pid68_S1AndS2, pid=0x68)
bind_layers(Service02, Pid69_S1AndS2, pid=0x69)
bind_layers(Service02, Pid6A_S1AndS2, pid=0x6A)
bind_layers(Service02, Pid6B_S1AndS2, pid=0x6B)
bind_layers(Service02, Pid6C_S1AndS2, pid=0x6C)
bind_layers(Service02, Pid6D_S1AndS2, pid=0x6D)
bind_layers(Service02, Pid6E_S1AndS2, pid=0x6E)
bind_layers(Service02, Pid6F_S1AndS2, pid=0x6F)
bind_layers(Service02, Pid70_S1AndS2, pid=0x70)
bind_layers(Service02, Pid71_S1AndS2, pid=0x71)
bind_layers(Service02, Pid72_S1AndS2, pid=0x72)
bind_layers(Service02, Pid73_S1AndS2, pid=0x73)
bind_layers(Service02, Pid74_S1AndS2, pid=0x74)
bind_layers(Service02, Pid75_S1AndS2, pid=0x75)
bind_layers(Service02, Pid76_S1AndS2, pid=0x76)
bind_layers(Service02, Pid77_S1AndS2, pid=0x77)
bind_layers(Service02, Pid78_S1AndS2, pid=0x78)
bind_layers(Service02, Pid79_S1AndS2, pid=0x79)
bind_layers(Service02, Pid7A_S1AndS2, pid=0x7A)
bind_layers(Service02, Pid7B_S1AndS2, pid=0x7B)
bind_layers(Service02, Pid7C_S1AndS2, pid=0x7C)
bind_layers(Service02, Pid7D_S1AndS2, pid=0x7D)
bind_layers(Service02, Pid7E_S1AndS2, pid=0x7E)
bind_layers(Service02, Pid7F_S1AndS2, pid=0x7F)
bind_layers(Service02, Pid80_S1AndS2, pid=0x80)
bind_layers(Service02, Pid81_S1AndS2, pid=0x81)
bind_layers(Service02, Pid82_S1AndS2, pid=0x82)
bind_layers(Service02, Pid83_S1AndS2, pid=0x83)
bind_layers(Service02, Pid84_S1AndS2, pid=0x84)
bind_layers(Service02, Pid85_S1AndS2, pid=0x85)
bind_layers(Service02, Pid86_S1AndS2, pid=0x86)
bind_layers(Service02, Pid87_S1AndS2, pid=0x87)
bind_layers(Service02, Pid88_S1AndS2, pid=0x88)
bind_layers(Service02, Pid89_S1AndS2, pid=0x89)
bind_layers(Service02, Pid8A_S1AndS2, pid=0x8A)
bind_layers(Service02, Pid8B_S1AndS2, pid=0x8B)
bind_layers(Service02, Pid8C_S1AndS2, pid=0x8C)
bind_layers(Service02, Pid8D_S1AndS2, pid=0x8D)
bind_layers(Service02, Pid8E_S1AndS2, pid=0x8E)
bind_layers(Service02, Pid8F_S1AndS2, pid=0x8F)
bind_layers(Service02, Pid90_S1AndS2, pid=0x90)
bind_layers(Service02, Pid91_S1AndS2, pid=0x91)
bind_layers(Service02, Pid92_S1AndS2, pid=0x92)
bind_layers(Service02, Pid93_S1AndS2, pid=0x93)
bind_layers(Service02, Pid94_S1AndS2, pid=0x94)
bind_layers(Service02, Pid98_S1AndS2, pid=0x98)
bind_layers(Service02, Pid99_S1AndS2, pid=0x99)
bind_layers(Service02, Pid9A_S1AndS2, pid=0x9A)
bind_layers(Service02, Pid9B_S1AndS2, pid=0x9B)
bind_layers(Service02, Pid9C_S1AndS2, pid=0x9C)
bind_layers(Service02, Pid9D_S1AndS2, pid=0x9D)
bind_layers(Service02, Pid9E_S1AndS2, pid=0x9E)
bind_layers(Service02, Pid9F_S1AndS2, pid=0x9F)
bind_layers(Service02, PidA0_S1AndS2, pid=0xA0)
bind_layers(Service02, PidA1_S1AndS2, pid=0xA1)
bind_layers(Service02, PidA2_S1AndS2, pid=0xA2)
bind_layers(Service02, PidA3_S1AndS2, pid=0xA3)
bind_layers(Service02, PidA4_S1AndS2, pid=0xA4)
bind_layers(Service02, PidA5_S1AndS2, pid=0xA5)
bind_layers(Service02, PidA6_S1AndS2, pid=0xA6)
bind_layers(Service02, PidC0_S1AndS2, pid=0xC0)


bind_layers(Service09, Pid00_S9, pid=0x00)
bind_layers(Service09, Pid01_S9, pid=0x01)
bind_layers(Service09, Pid02_S9, pid=0x02)
bind_layers(Service09, Pid03_S9, pid=0x03)
bind_layers(Service09, Pid04_S9, pid=0x04)
bind_layers(Service09, Pid05_S9, pid=0x05)
bind_layers(Service09, Pid06_S9, pid=0x06)
bind_layers(Service09, Pid07_S9, pid=0x07)
bind_layers(Service09, Pid08_S9, pid=0x08)
bind_layers(Service09, Pid09_S9, pid=0x09)
bind_layers(Service09, Pid0A_S9, pid=0x0A)
bind_layers(Service09, Pid0B_S9, pid=0x0B)
